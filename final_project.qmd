---
title: "Employment Trends Analysis in Canada: 2015-2019 vs. 2020-2024"
author: Ya-Nuo, Hsu and Kevin Johnson
fontsize: 12pt
mainfont: "Times New Roman"
output: 
  pdf_document:
    latex_engine: xelatex
    toc: true
    number_sections: true
---

```{r setup, include=FALSE}
# Load required libraries
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggplot2)

employment_trends <- read.csv("~/Desktop/Stat 184/employment_trends.csv")

employment_trends_clean <- employment_trends %>%
  filter(REF_DATE >= "2015-01" & REF_DATE <= "2024-12",
         UOM != "Dollars") %>%
  mutate(
    REF_DATE = as.character(REF_DATE),
    Employment = replace_na(VALUE, 0), 
    Period = ifelse(REF_DATE < "2020-01", "Pre-Pandemic", "Post-Pandemic")
  ) %>%
  select(-c(DGUID, SYMBOL, TERMINATED, SCALAR_FACTOR, SCALAR_ID, STATUS, DECIMALS, Estimate, VECTOR, COORDINATE, UOM_ID)) %>%
  rename(
    Industry = North.American.Industry.Classification.System..NAICS., 
    Region = GEO,
    Date = REF_DATE
  )

write.csv(employment_trends_clean, "employment_trends_clean.csv", row.names = FALSE)

post_pandemic_employment_trends <- employment_trends_clean %>%
  filter(Date >= "2020-01" & Date <= "2024-12")

pre_pandemic_employment_trends <- employment_trends_clean %>%
  filter(Date >= "2015-01" & Date <= "2019-12")

# Set global options
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.align = "center")
```

## Introduction

Employment trends are a key indicator of economic performance and recovery, particularly during periods of disruption. In this report, we analyze how employment in Canada has evolved over two distinct periods: the pre-pandemic years (2015–2019) and the post-pandemic years (2020–2024). The goal is to identify changes in employment trends across industries and regions, using data spanning from 2015 to 2024. In this study, we will be researching the questions: How were employment trends in the major industries in Canada affected by the COVID-19 pandemic? We will look at different factors of this data and compare employment levels across different industries and geographical regions. We will group these industries into two different groups: Goods producing industries and service producing industries. The goods producing industries are made up of Construction, Manufacturing, and Mining, and the service producing industries are made up of Accommodation and food services, Healthcare, and Transportation and warehousing.

## Provenance

We found our data on Kaggle, and it is sourced from the Survey of Employment, Payrolls, and Hours. This data was collected to provide information about employment levels and includes variables such as geographical region, industry, and employment level. Each case is represented by the employment of a specific industry in a specific geographic region for a given month and year.

## Literature Review

Employment trends have been extensively studied, especially during periods of economic recovery following major events like the COVID-19 pandemic. Studies have identified regional and industry-specific disparities in employment recovery post-pandemic. For instance, service-based industries often experience slower recovery compared to technology-driven sectors. This section will explore relevant literature on employment trends in Canada and similar economies, emphasizing regional and industrial differences.

The COVID-19 Pandemic had a drastic effect on the Canadian economy and labor market, causing changes in employment levels. The article from StatCan (2022) mentions that between January 2020 and May 2020, Canada saw roughly 3.4 million jobs lost (nearly 20% of employment). RBC (2022) highlights the change in employment across different sectors, and how employment seemed to rise post pandemic in low contact industries, such as finance, but fell in high contact industries, such as accommodation and food services. Environics Analytics (2021) goes into detail on how population growth decreased across regions in 2020, as compared to the growth it experienced in 2018 and 2019. It also mentions an overall decline in mental health amongst Canadians, illustrating the fact that COVID had great impacts in Canada beyond just employment.

## Methodology

We use a publicly available dataset covering monthly employment data from 2015 to 2024. The dataset includes fields for regions, industries, and employment numbers. Data were filtered to include only the years of interest (2015–2024) and were classified into two periods: Pre-Pandemic (2015–2019) and Post-Pandemic (2020–2024).

Statistical analysis and visualizations are used to identify trends and significant differences between these periods.

Our main goal is to investigate employment trends across major industry sectors in Canada and how they were affected by COVID-19. Through statistical analysis and data visualization, we will see how employment level was affected by the pandemic, and how different industries rebounded from the pandemic. We will look at factors such as geographic region to compare these trends across different regions in Canada.

## Data Exploration

```{r data_clean, echo=FALSE}
summary_stats <- employment_trends_clean %>%
  filter(Region == "Canada") %>% 
  group_by(Period, Industry) %>%
  summarise(
    Avg_Employment = mean(Employment, na.rm = TRUE),
    Min_Employment = min(Employment, na.rm = TRUE),
    Max_Employment = max(Employment, na.rm = TRUE),
    SD_Employment = sd(Employment, na.rm = TRUE)
  ) %>%
  arrange(Industry, Period)

kable(summary_stats, caption = "Summary Statistics for Employment Trends in Canada") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  scroll_box(height = "500px")
```

This five number summary table includes key statistics regarding the employment level across different industries both before and after the COVID-19 pandemic and it provides us with an idea of the employment distribution across. The industry “Industrial aggregate including unclassified businesses” groups all the industries together and provides us with insight to the employment of Canada as a whole. The data from the aggregate grouping of industries allows us to compare individual industries to the total employment in Canada, and it sets a baseline for comparing these industries with each other.

We will also use this summary table to get a basis for the major industries we will be researching: Goods producing industries (Construction, Manufacturing, and Mining) and service producing industries (Accommodation and food services, Healthcare, and Transportation and warehousing).

## Visualization: Employment Trends Over Time

```{r trends, echo=FALSE}
filtered_data_canada <- employment_trends_clean %>%
  filter(
    Region == "Canada", 
    Industry %in% c("Goods producing industries [11-33N]", 
                    "Service producing industries [41-91N]")
  )
industry_trends_canada <- filtered_data_canada %>%
  group_by(Date, Industry) %>%
  summarise(Total_Employment = sum(Employment, na.rm = TRUE)) %>%
  ungroup()

ggplot(industry_trends_canada, aes(x = Date, y = Total_Employment, color = Industry, group = Industry)) +
  geom_line(size = 1.2) +
  labs(
    title = "Employment Trends Over Time in Canada (2015–2024)",
    subtitle = "Comparison of Goods Producing and Service Producing Industries",
    x = "Year-Month",
    y = "Total Employment",
    color = "Industry"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 10)
  ) +
  scale_x_discrete(
    breaks = c("2015-01", "2017-01", "2019-01", "2021-01", "2023-01")
  ) +
  scale_y_continuous(labels = scales::comma)
```

```{r goods_ind, echo=FALSE}
#goods_industries
goods_industries <- c("Manufacturing [31-33]", 
                      "Construction [23]", 
                      "Mining, quarrying, and oil and gas extraction [21]")
goods_data <- employment_trends_clean %>%
  filter(
    Industry %in% goods_industries,
    Region == "Canada"
  )
goods_summary <- goods_data %>%
  group_by(Industry, Period) %>%
  summarise(Average_Employment = mean(Employment, na.rm = TRUE)) %>%
  ungroup()

goods_summary <- goods_summary %>%
  mutate(Period = factor(Period, levels = c("Pre-Pandemic", "Post-Pandemic")))

ggplot(goods_summary, aes(x = Industry, y = Average_Employment, fill = Period)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_text(aes(label = scales::comma(round(Average_Employment, 0))), 
            position = position_dodge(width = 0.9), 
            vjust = -0.25, size = 3) +
  labs(
    title = "Average Employment Levels: Goods Producing Industries",
    subtitle = "Pre-Pandemic (2015–2019) vs Post-Pandemic (2020–2024)",
    x = "Industry",
    y = "Average Employment"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom"
  ) +
  scale_fill_manual(values = c("Pre-Pandemic" = "#2C7FB8", "Post-Pandemic" = "#D95F02")) +
  scale_y_continuous(labels = scales::comma)
```

```{r service_ind, echo=FALSE}
#service_industries
service_industries <- c("Health care and social assistance [62]",
                        "Accommodation and food services [72]",
                        "Transportation and warehousing [48-49]")

service_data <- employment_trends_clean %>%
  filter(
    Industry %in% service_industries,
    Region == "Canada"
  )

service_summary <- service_data %>%
  group_by(Industry, Period) %>%
  summarise(Average_Employment = mean(Employment, na.rm = TRUE)) %>%
  ungroup()

service_summary <- service_summary %>%
  mutate(Period = factor(Period, levels = c("Pre-Pandemic", "Post-Pandemic")))

ggplot(service_summary, aes(x = Industry, y = Average_Employment, fill = Period)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_text(aes(label = scales::comma(round(Average_Employment, 0))), 
            position = position_dodge(width = 0.9), 
            vjust = -0.25, size = 3) +
  labs(
    title = "Average Employment Levels: Service Producing Industries",
    subtitle = "Pre-Pandemic (2015–2019) vs Post-Pandemic (2020–2024)",
    x = "Industry",
    y = "Average Employment"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom"
  ) +
  scale_fill_manual(values = c("Pre-Pandemic" = "#2C7FB8", "Post-Pandemic" = "#D95F02")) +
  scale_y_continuous(labels = scales::comma)
```

## Results

## Conclusion

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```
